""" This script matches set B to set A using the transformation
    R and T for B resulting set C
    Sets A and B already connected as nearest (Ai stands for Bi)
    Indexes mustn't be shuffled
"""

import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D


def count_xyz_sum(a):
    s = np.sum(a, axis=0)
    return s[0], s[1], s[2]


def count_mimj(b, i, j):
    return np.sum(b[:,i]*b[:,j])


def count_simj(a, b, i, j):
    return np.sum(a[:,i]*b[:,j])


def count_eps(a, c):
    return np.sum((c[:,0]-a[:,0])**2 + (c[:,1]-a[:,1])**2 + (c[:,2]-a[:,2])**2)


np.random.seed(42)

n = 10
a = np.random.rand(n,3)
a = a
print(a, end='\n\n')

alpha_1 = -0.011
betha_1 = 0.072
gamma_1 = -0.036
trans_1_x = -0.05
trans_1_y = -0.02
trans_1_z = 0.076
rot_1 = np.array([[1, -gamma_1, -betha_1],
                [gamma_1, 1, -alpha_1],
                [betha_1, alpha_1, 1]])
trans_1 = np.array([trans_1_x, trans_1_y, trans_1_z])

b = np.zeros((n,3))
d = np.zeros((n,3))
for i, point in enumerate(a):
    b[i] = np.dot(rot_1, point) + trans_1
    d[i] = np.dot(rot_1, point)
print(b, end='\n\n')

mxx = count_mimj(b, 0, 0)
myy = count_mimj(b, 1, 1)
mzz = count_mimj(b, 2, 2)
mxy = count_mimj(b, 0, 1)
mxz = count_mimj(b, 0, 2)
myz = count_mimj(b, 1, 2)
mx, my, mz = count_xyz_sum(b)
sx, sy, sz = count_xyz_sum(a)
symz = count_simj(a, b, 1, 2)
szmy = count_simj(a, b, 2, 1)
sxmz = count_simj(a, b, 0, 2)
szmx = count_simj(a, b, 2, 0)
sxmy = count_simj(a, b, 0, 1)
symx = count_simj(a, b, 1, 0)

alpha = -(mx**4*symz - mx**4*szmy - mx*my**3*sxmz - mx**3*my*sxmz - mx**3*mxz*sy + mx*mz**3*sxmy + mx**3*mz*sxmy + mx**3*mxy*sz + mx*my**3*szmx - mx*mz**3*symx + mx**3*my*szmx - mx**3*mz*symx - mxx*my**3*sz + mxx*mz**3*sy + myy*mz**3*sy - my**3*mzz*sz + mx**2*my**2*symz - mx**2*my**2*szmy + mx**2*mz**2*symz - mx**2*mz**2*szmy + mxx**2*n**2*symz - mxx**2*n**2*szmy - myz**2*n**2*symz + myz**2*n**2*szmy + mx**2*mxz*my*sx - mx**2*mxy*mz*sx + mx*my**2*myz*sx + mx*my**2*mz*sxmy - mx*my*mz**2*sxmz - mx**2*mxx*my*sz + mx**2*mxx*mz*sy + mx*mxy*my**2*sz - mx*mxz*mz**2*sy - mx*myz*mz**2*sx - mx**2*my*myz*sy - mx*my**2*mz*symx + mxx*my**2*mz*sy + mx**2*myy*mz*sy + mx*my*mz**2*szmx - mxx*my*mz**2*sz - 2*my*myz*mz**2*sy - mx**2*my*mzz*sz + mx**2*myz*mz*sz - my*myy*mz**2*sz + 2*my**2*myz*mz*sz + my**2*mz*mzz*sy + mx**2*mxy*n*sxmz - mx**2*mxz*n*sxmy - mxx*mxy*n**2*sxmz + mxx*mxz*n**2*sxmy - 2*mx**2*mxx*n*symz + mxy*my**2*n*sxmz + mx**2*mxz*n*symx - mxx*mxz*n**2*symx - mxy*myy*n**2*sxmz + mxy*myz*n**2*sxmy - mxz*myz*n**2*sxmz + 2*mx**2*mxx*n*szmy - mxx*my**2*n*symz - mx**2*mxy*n*szmx - mx**2*myy*n*symz - mxz*mz**2*n*sxmy + mxx*mxy*n**2*szmx + mxx*myy*n**2*symz - mxy*myz*n**2*symx + mxz*mzz*n**2*sxmy + mxx**2*my*n*sz - mxx**2*mz*n*sy + mxx*my**2*n*szmy - mxx*mz**2*n*symz - mxy*my**2*n*szmx + mx**2*myy*n*szmy + mxz*mz**2*n*symx - mx**2*mzz*n*symz - mxx*myy*n**2*szmy + mxy*myy*n**2*szmx + mxx*mzz*n**2*symz + mxz*myz*n**2*szmx - mxz*mzz*n**2*symx - my*myz**2*n*sz + myz**2*mz*n*sy + mxx*mz**2*n*szmy - myy*mz**2*n*symz + mx**2*mzz*n*szmy - my**2*mzz*n*symz - mxx*mzz*n**2*szmy + myy*mzz*n**2*symz + myy*mz**2*n*szmy + my**2*mzz*n*szmy - myy*mzz*n**2*szmy - mx*mxy*my*mz*sy - mx*my*myy*mz*sx + mx*mxz*my*mz*sz + mx*my*mz*mzz*sx + mx*mxx*my*n*sxmz + mx*mxx*mxz*n*sy - mxx*mxz*my*n*sx - mx*mxx*mz*n*sxmy + mx*my*myy*n*sxmz - mx*my*myz*n*sxmy - mx*mxx*mxy*n*sz + mxx*mxy*mz*n*sx + mx*mxy*myz*n*sy - mxy*my*myz*n*sx - mx*mxx*my*n*szmx + mx*mxx*mz*n*symx - mxy*my*mz*n*sxmy + mx*my*myz*n*symx + mx*myz*mz*n*sxmz + mxz*my*mz*n*sxmz - mx*mxy*myy*n*sz + mxy*myy*mz*n*sx - mx*mxz*myz*n*sz + mx*mxz*mzz*n*sy - mxz*my*mzz*n*sx + mxz*myz*mz*n*sx - mx*my*myy*n*szmx + mxy*my*mz*n*symx - mx*mz*mzz*n*sxmy + mxx*my*myy*n*sz - mxx*myy*mz*n*sy - mx*myz*mz*n*szmx + mx*mz*mzz*n*symx - mxz*my*mz*n*szmx + 2*my*myz*mz*n*symz + mxx*my*mzz*n*sz - mxx*mz*mzz*n*sy - 2*my*myz*mz*n*szmy + my*myy*mzz*n*sz - myy*mz*mzz*n*sy)/(mx**4*myy + mx**4*mzz - 2*mx**3*mxy*my - 2*mx**3*mxz*mz + mx**2*mxx*my**2 - 2*mx**2*mxx*myy*n + mx**2*mxx*mz**2 - 2*mx**2*mxx*mzz*n + mx**2*mxy**2*n + mx**2*mxz**2*n + mx**2*my**2*myy + 2*mx**2*my**2*mzz - 2*mx**2*my*myz*mz - mx**2*myy**2*n + 2*mx**2*myy*mz**2 - 2*mx**2*myy*mzz*n + mx**2*mz**2*mzz - mx**2*mzz**2*n + 2*mx*mxx*mxy*my*n + 2*mx*mxx*mxz*mz*n - 2*mx*mxy*my**3 + 2*mx*mxy*my*myy*n - 2*mx*mxy*my*mz**2 + 2*mx*mxy*myz*mz*n - 2*mx*mxz*my**2*mz + 2*mx*mxz*my*myz*n - 2*mx*mxz*mz**3 + 2*mx*mxz*mz*mzz*n - mxx**2*my**2*n + mxx**2*myy*n**2 - mxx**2*mz**2*n + mxx**2*mzz*n**2 - mxx*mxy**2*n**2 - mxx*mxz**2*n**2 + mxx*my**4 - 2*mxx*my**2*myy*n + 2*mxx*my**2*mz**2 - 2*mxx*my**2*mzz*n + mxx*myy**2*n**2 - 2*mxx*myy*mz**2*n + 2*mxx*myy*mzz*n**2 + mxx*mz**4 - 2*mxx*mz**2*mzz*n + mxx*mzz**2*n**2 + mxy**2*my**2*n - mxy**2*myy*n**2 + 2*mxy*mxz*my*mz*n - 2*mxy*mxz*myz*n**2 + mxz**2*mz**2*n - mxz**2*mzz*n**2 + my**4*mzz - 2*my**3*myz*mz + my**2*myy*mz**2 - 2*my**2*myy*mzz*n + my**2*myz**2*n + my**2*mz**2*mzz - my**2*mzz**2*n + 2*my*myy*myz*mz*n - 2*my*myz*mz**3 + 2*my*myz*mz*mzz*n - myy**2*mz**2*n + myy**2*mzz*n**2 - myy*myz**2*n**2 + myy*mz**4 - 2*myy*mz**2*mzz*n + myy*mzz**2*n**2 + myz**2*mz**2*n - myz**2*mzz*n**2)
betha = -(my**4*sxmz - my**4*szmx - mx*my**3*symz - mx**3*my*symz + mxx*mz**3*sx - my**3*myz*sx + mx*my**3*szmy - my*mz**3*sxmy + mx**3*my*szmy - my**3*mz*sxmy + mxy*my**3*sz + myy*mz**3*sx - mx**3*myy*sz + my*mz**3*symx + my**3*mz*symx - mx**3*mzz*sz + mx**2*my**2*sxmz - mx**2*my**2*szmx + my**2*mz**2*sxmz - my**2*mz**2*szmx - mxz**2*n**2*sxmz + myy**2*n**2*sxmz + mxz**2*n**2*szmx - myy**2*n**2*szmx - mx*mxz*my**2*sx - 2*mx*mxz*mz**2*sx + mx**2*mxz*my*sy - mx**2*my*mz*sxmy + mxx*my**2*mz*sx + mx**2*mxy*my*sz + mx**2*myy*mz*sx + mx*my**2*myz*sy + mx**2*my*mz*symx - mx*my*mz**2*symz - mx*mxx*mz**2*sz - mx*my**2*myy*sz - mxy*my**2*mz*sy + my**2*myy*mz*sx - mxz*my*mz**2*sy - my*myz*mz**2*sx + 2*mx**2*mxz*mz*sz + mx**2*mz*mzz*sx + mx*my*mz**2*szmy - mx*myy*mz**2*sz - mx*my**2*mzz*sz + mxz*my**2*mz*sz - mxy*mxz*n**2*sxmy - mxx*my**2*n*sxmz + mx**2*mxy*n*symz - mx**2*myy*n*sxmz - mxx*mxy*n**2*symz + mxx*myy*n**2*sxmz + mxy*mxz*n**2*symx - mx*mxz**2*n*sz + mxz**2*mz*n*sx - mxx*mz**2*n*sxmz - mx**2*mxy*n*szmy + mxy*my**2*n*symz - 2*my**2*myy*n*sxmz + my**2*myz*n*sxmy - mx**2*mzz*n*sxmz + mxx*mxy*n**2*szmy + mxx*mzz*n**2*sxmz - mxy*myy*n**2*symz - myy*myz*n**2*sxmy - mxz*myz*n**2*symz + mx*myy**2*n*sz - myy**2*mz*n*sx + mxx*my**2*n*szmx + mx**2*myy*n*szmx - mxy*my**2*n*szmy - myy*mz**2*n*sxmz - my**2*myz*n*symx + myz*mz**2*n*sxmy - my**2*mzz*n*sxmz - mxx*myy*n**2*szmx + mxy*myy*n**2*szmy + myy*myz*n**2*symx + myy*mzz*n**2*sxmz + mxz*myz*n**2*szmy - myz*mzz*n**2*sxmy + mxx*mz**2*n*szmx + 2*my**2*myy*n*szmx - myz*mz**2*n*symx + mx**2*mzz*n*szmx - mxx*mzz*n**2*szmx + myz*mzz*n**2*symx + myy*mz**2*n*szmx + my**2*mzz*n*szmx - myy*mzz*n**2*szmx - mx*mxy*my*mz*sx - mx*mxx*my*mz*sy + mx*my*myz*mz*sz + mx*my*mz*mzz*sy + mx*mxz*my*n*sxmy - mx*mxy*mxz*n*sy + mxy*mxz*my*n*sx + mx*mxx*my*n*symz + mx*mxy*mz*n*sxmy - mx*mxz*my*n*symx + 2*mx*mxz*mz*n*sxmz - mx*mxx*my*n*szmy - mx*mxy*mz*n*symx + mx*my*myy*n*symz + mx*mxx*myy*n*sz - mxx*mxy*my*n*sz + mxx*mxy*mz*n*sy - mxx*myy*mz*n*sx - mx*myy*myz*n*sy + my*myy*myz*n*sx - mx*my*myy*n*szmy + my*myy*mz*n*sxmy - 2*mx*mxz*mz*n*szmx + mx*myz*mz*n*symz + mxz*my*mz*n*symz + mx*mxx*mzz*n*sz - mxx*mz*mzz*n*sx - mxy*my*myy*n*sz + mxy*myy*mz*n*sy - mx*myz*mzz*n*sy - mxz*my*myz*n*sz + mxz*myz*mz*n*sy + my*myz*mzz*n*sx - my*myy*mz*n*symx - mx*myz*mz*n*szmy - mxz*my*mz*n*szmy + my*mz*mzz*n*sxmy + mx*myy*mzz*n*sz - myy*mz*mzz*n*sx - my*mz*mzz*n*symx)/(mx**4*myy + mx**4*mzz - 2*mx**3*mxy*my - 2*mx**3*mxz*mz + mx**2*mxx*my**2 - 2*mx**2*mxx*myy*n + mx**2*mxx*mz**2 - 2*mx**2*mxx*mzz*n + mx**2*mxy**2*n + mx**2*mxz**2*n + mx**2*my**2*myy + 2*mx**2*my**2*mzz - 2*mx**2*my*myz*mz - mx**2*myy**2*n + 2*mx**2*myy*mz**2 - 2*mx**2*myy*mzz*n + mx**2*mz**2*mzz - mx**2*mzz**2*n + 2*mx*mxx*mxy*my*n + 2*mx*mxx*mxz*mz*n - 2*mx*mxy*my**3 + 2*mx*mxy*my*myy*n - 2*mx*mxy*my*mz**2 + 2*mx*mxy*myz*mz*n - 2*mx*mxz*my**2*mz + 2*mx*mxz*my*myz*n - 2*mx*mxz*mz**3 + 2*mx*mxz*mz*mzz*n - mxx**2*my**2*n + mxx**2*myy*n**2 - mxx**2*mz**2*n + mxx**2*mzz*n**2 - mxx*mxy**2*n**2 - mxx*mxz**2*n**2 + mxx*my**4 - 2*mxx*my**2*myy*n + 2*mxx*my**2*mz**2 - 2*mxx*my**2*mzz*n + mxx*myy**2*n**2 - 2*mxx*myy*mz**2*n + 2*mxx*myy*mzz*n**2 + mxx*mz**4 - 2*mxx*mz**2*mzz*n + mxx*mzz**2*n**2 + mxy**2*my**2*n - mxy**2*myy*n**2 + 2*mxy*mxz*my*mz*n - 2*mxy*mxz*myz*n**2 + mxz**2*mz**2*n - mxz**2*mzz*n**2 + my**4*mzz - 2*my**3*myz*mz + my**2*myy*mz**2 - 2*my**2*myy*mzz*n + my**2*myz**2*n + my**2*mz**2*mzz - my**2*mzz**2*n + 2*my*myy*myz*mz*n - 2*my*myz*mz**3 + 2*my*myz*mz*mzz*n - myy**2*mz**2*n + myy**2*mzz*n**2 - myy*myz**2*n**2 + myy*mz**4 - 2*myy*mz**2*mzz*n + myy*mzz**2*n**2 + myz**2*mz**2*n - myz**2*mzz*n**2)
gamma = -(mz**4*sxmy - mz**4*symx + mxx*my**3*sx - mx**3*myy*sy + mx*mz**3*symz - my*mz**3*sxmz + mx**3*mz*symz - my**3*mz*sxmz + mxz*mz**3*sy - myz*mz**3*sx - mx**3*mzz*sy + my**3*mzz*sx - mx*mz**3*szmy - mx**3*mz*szmy + my*mz**3*szmx + my**3*mz*szmx + mx**2*mz**2*sxmy - mx**2*mz**2*symx + my**2*mz**2*sxmy - my**2*mz**2*symx - mxy**2*n**2*sxmy + mxy**2*n**2*symx + mzz**2*n**2*sxmy - mzz**2*n**2*symx - 2*mx*mxy*my**2*sx - mx*mxx*my**2*sy - mx*mxy*mz**2*sx + 2*mx**2*mxy*my*sy + mx**2*my*myy*sx - mx**2*my*mz*sxmz + mxx*my*mz**2*sx + mx**2*mxz*mz*sy + mx**2*my*mzz*sx + mx*my**2*mz*symz - mx*myy*mz**2*sy + mxy*my*mz**2*sy + mx**2*mxy*mz*sz - mx*my**2*mzz*sy - my**2*myz*mz*sx + mx**2*my*mz*szmx - mx*my**2*mz*szmy - mxy*my**2*mz*sz + mx*myz*mz**2*sz - mx*mz**2*mzz*sy - mxz*my*mz**2*sz + my*mz**2*mzz*sx - mxy*mxz*n**2*sxmz - mx*mxy**2*n*sy + mxy**2*my*n*sx - mxx*my**2*n*sxmy - mx**2*myy*n*sxmy - mx**2*mxz*n*symz + mxx*myy*n**2*sxmy + mxx*mxz*n**2*symz + mxx*my**2*n*symx - mxx*mz**2*n*sxmy + mx**2*myy*n*symx + mx**2*mxz*n*szmy - mx**2*mzz*n*sxmy + my**2*myz*n*sxmz - mxx*myy*n**2*symx - mxx*mxz*n**2*szmy + mxx*mzz*n**2*sxmy + mxy*mxz*n**2*szmx + mxy*myz*n**2*symz - myy*myz*n**2*sxmz + mx*mzz**2*n*sy - my*mzz**2*n*sx + mxx*mz**2*n*symx - myy*mz**2*n*sxmy + mx**2*mzz*n*symx - my**2*mzz*n*sxmy - mxz*mz**2*n*symz + myz*mz**2*n*sxmz - mxx*mzz*n**2*symx - mxy*myz*n**2*szmy + myy*mzz*n**2*sxmy + mxz*mzz*n**2*symz - myz*mzz*n**2*sxmz + myy*mz**2*n*symx - my**2*myz*n*szmx + my**2*mzz*n*symx + mxz*mz**2*n*szmy - 2*mz**2*mzz*n*sxmy + myy*myz*n**2*szmx - myy*mzz*n**2*symx - mxz*mzz*n**2*szmy - myz*mz**2*n*szmx + 2*mz**2*mzz*n*symx + myz*mzz*n**2*szmx - mx*mxz*my*mz*sx - mx*mxx*my*mz*sz + mx*my*myz*mz*sy + mx*my*myy*mz*sz + 2*mx*mxy*my*n*sxmy + mx*mxz*my*n*sxmz - 2*mx*mxy*my*n*symx + mx*mxy*mz*n*sxmz + mx*mxx*myy*n*sy - mxx*my*myy*n*sx - mx*mxy*mxz*n*sz + mxy*mxz*mz*n*sx - mx*mxx*mz*n*symz - mx*mxz*my*n*szmx - mx*my*myz*n*symz + mx*mxx*mzz*n*sy + mxx*mxz*my*n*sz - mxx*mxz*mz*n*sy - mxx*my*mzz*n*sx + mx*mxx*mz*n*szmy - mx*mxy*mz*n*szmx - mxy*my*mz*n*symz + my*myy*mz*n*sxmz + mx*my*myz*n*szmy - mx*myy*myz*n*sz + mx*myy*mzz*n*sy + mxy*my*myz*n*sz - mxy*myz*mz*n*sy - my*myy*mzz*n*sx + myy*myz*mz*n*sx + mxy*my*mz*n*szmy - mx*mz*mzz*n*symz + my*mz*mzz*n*sxmz - mx*myz*mzz*n*sz + mxz*my*mzz*n*sz - mxz*mz*mzz*n*sy + myz*mz*mzz*n*sx - my*myy*mz*n*szmx + mx*mz*mzz*n*szmy - my*mz*mzz*n*szmx)/(mx**4*myy + mx**4*mzz - 2*mx**3*mxy*my - 2*mx**3*mxz*mz + mx**2*mxx*my**2 - 2*mx**2*mxx*myy*n + mx**2*mxx*mz**2 - 2*mx**2*mxx*mzz*n + mx**2*mxy**2*n + mx**2*mxz**2*n + mx**2*my**2*myy + 2*mx**2*my**2*mzz - 2*mx**2*my*myz*mz - mx**2*myy**2*n + 2*mx**2*myy*mz**2 - 2*mx**2*myy*mzz*n + mx**2*mz**2*mzz - mx**2*mzz**2*n + 2*mx*mxx*mxy*my*n + 2*mx*mxx*mxz*mz*n - 2*mx*mxy*my**3 + 2*mx*mxy*my*myy*n - 2*mx*mxy*my*mz**2 + 2*mx*mxy*myz*mz*n - 2*mx*mxz*my**2*mz + 2*mx*mxz*my*myz*n - 2*mx*mxz*mz**3 + 2*mx*mxz*mz*mzz*n - mxx**2*my**2*n + mxx**2*myy*n**2 - mxx**2*mz**2*n + mxx**2*mzz*n**2 - mxx*mxy**2*n**2 - mxx*mxz**2*n**2 + mxx*my**4 - 2*mxx*my**2*myy*n + 2*mxx*my**2*mz**2 - 2*mxx*my**2*mzz*n + mxx*myy**2*n**2 - 2*mxx*myy*mz**2*n + 2*mxx*myy*mzz*n**2 + mxx*mz**4 - 2*mxx*mz**2*mzz*n + mxx*mzz**2*n**2 + mxy**2*my**2*n - mxy**2*myy*n**2 + 2*mxy*mxz*my*mz*n - 2*mxy*mxz*myz*n**2 + mxz**2*mz**2*n - mxz**2*mzz*n**2 + my**4*mzz - 2*my**3*myz*mz + my**2*myy*mz**2 - 2*my**2*myy*mzz*n + my**2*myz**2*n + my**2*mz**2*mzz - my**2*mzz**2*n + 2*my*myy*myz*mz*n - 2*my*myz*mz**3 + 2*my*myz*mz*mzz*n - myy**2*mz**2*n + myy**2*mzz*n**2 - myy*myz**2*n**2 + myy*mz**4 - 2*myy*mz**2*mzz*n + myy*mzz**2*n**2 + myz**2*mz**2*n - myz**2*mzz*n**2)
trans_x = -(mx**5*myy + mx**5*mzz + mx*mxx*my**4 - 2*mx**4*mxy*my + mx*mxx*mz**4 - 2*mx**4*mxz*mz + mx*myy*mz**4 + mx*my**4*mzz - mx**4*myy*sx - mx**4*mzz*sx + mx**3*mxx*my**2 - 2*mx**2*mxy*my**3 + mx**3*mxx*mz**2 + mx**3*my**2*myy - 2*mx**2*mxz*mz**3 + 2*mx**3*myy*mz**2 + 2*mx**3*my**2*mzz + mx**3*mz**2*mzz + mx**3*mxy**2*n + mx**3*mxz**2*n - mx**3*myy**2*n - mx**3*mzz**2*n - 2*mx*my*myz*mz**3 - 2*mx*my**3*myz*mz - 2*mx**3*my*myz*mz - 2*mx**3*mxx*myy*n - 2*mx**3*mxx*mzz*n - 2*mx**3*myy*mzz*n + 2*mx**3*mxy*my*sx - mx*mxx*my**3*sy + 2*mx**3*mxz*mz*sx - mx**3*my*myy*sy - mx*mxx*mz**3*sz - mx*my**3*mzz*sy - mx**3*my*mzz*sy - mx*myy*mz**3*sz - mx**3*myy*mz*sz - mx**3*mz*mzz*sz - mxx*my**3*n*sxmy + mxx*my**3*n*symx - mxx*mz**3*n*sxmz + my**3*myz*n*sxmz - myy*mz**3*n*sxmz + myz*mz**3*n*sxmy - my**3*mzz*n*sxmy + mxx*mz**3*n*szmx - myz*mz**3*n*symx - my**3*myz*n*szmx + my**3*mzz*n*symx + myy*mz**3*n*szmx + 2*mx*mxx*my**2*mz**2 - 2*mx**2*mxy*my*mz**2 - 2*mx**2*mxz*my**2*mz + mx*my**2*myy*mz**2 + mx*my**2*mz**2*mzz - mx*mxx*mxy**2*n**2 - mx*mxx*mxz**2*n**2 - mx*mxx**2*my**2*n + mx*mxy**2*my**2*n + mx*mxx*myy**2*n**2 + mx*mxx**2*myy*n**2 - mx*mxy**2*myy*n**2 - mx*mxx**2*mz**2*n + mx*mxz**2*mz**2*n + mx*my**2*myz**2*n + mx*mxx*mzz**2*n**2 + mx*mxx**2*mzz*n**2 - mx*myy*myz**2*n**2 - mx*mxz**2*mzz*n**2 - mx*myy**2*mz**2*n - mx*my**2*mzz**2*n + mx*myz**2*mz**2*n + mx*myy*mzz**2*n**2 + mx*myy**2*mzz*n**2 - mx*myz**2*mzz*n**2 - mx**2*mxx*my**2*sx - mx**2*mxx*mz**2*sx + 2*mx**2*mxy*my**2*sy - mx**2*myy*mz**2*sx - mx**2*my**2*mzz*sx + 2*mx**2*mxz*mz**2*sz - mx**2*mxy**2*n*sx - mx**2*mxz**2*n*sx + mxx*mxy**2*n**2*sx + mxx*mxz**2*n**2*sx + mxx**2*my**2*n*sx + mx**2*myy**2*n*sx - mxy**2*my*n**2*sxmy - mxx*myy**2*n**2*sx - mxx**2*myy*n**2*sx + mxy**2*myy*n**2*sx + mxx**2*mz**2*n*sx + mx**2*mzz**2*n*sx - my**2*myz**2*n*sx + mxy**2*my*n**2*symx - mxz**2*mz*n**2*sxmz - mxx*mzz**2*n**2*sx - mxx**2*mzz*n**2*sx + myy*myz**2*n**2*sx + mxz**2*mzz*n**2*sx - myz**2*mz**2*n*sx + myy**2*mz*n**2*sxmz + my*mzz**2*n**2*sxmy - myy*mzz**2*n**2*sx - myy**2*mzz*n**2*sx + myz**2*mzz*n**2*sx - my*mzz**2*n**2*symx + mxz**2*mz*n**2*szmx - myy**2*mz*n**2*szmx + 2*mx**2*mxx*mxy*my*n - 2*mx*mxy*mxz*myz*n**2 - 2*mx*mxx*my**2*myy*n + 2*mx**2*mxx*mxz*mz*n + 2*mx**2*mxy*my*myy*n + 2*mx**2*mxz*my*myz*n - 2*mx*mxx*myy*mz**2*n - 2*mx*mxx*my**2*mzz*n + 2*mx**2*mxy*myz*mz*n + 2*mx*mxx*myy*mzz*n**2 - 2*mx*mxx*mz**2*mzz*n - 2*mx*my**2*myy*mzz*n + 2*mx**2*mxz*mz*mzz*n - 2*mx*myy*mz**2*mzz*n - mx*mxx*my*mz**2*sy + 2*mx**2*mxz*my*mz*sy + 2*mx**2*my*myz*mz*sx - mx*mxx*my**2*mz*sz - mx*my*myy*mz**2*sy + 2*mx**2*mxy*my*mz*sz + 2*mx*my**2*myz*mz*sy + 2*mx*my*myz*mz**2*sz - mx*my**2*mz*mzz*sz + 2*mx*mxy*my**2*n*sxmy + mx*mxz*my**2*n*sxmz + 2*mx**2*mxx*myy*n*sx - mxy*mxz*my*n**2*sxmz + 2*mxy*mxz*myz*n**2*sx - mx*mxy**2*my*n*sy - 2*mx*mxy*my**2*n*symx + mx*mxy*mz**2*n*sxmy - mx**2*my*myy*n*sxmy + 2*mx*mxz*mz**2*n*sxmz - mx**2*mxz*my*n*symz + mxx*my**2*myy*n*sx + 2*mx**2*mxx*mzz*n*sx + mxx*my*myy*n**2*sxmy + mxx*mxz*my*n**2*symz - mxy*mxz*mz*n**2*sxmy - mxx*my*mz**2*n*sxmy - mxx*my**2*mz*n*sxmz - mx*mxy*mz**2*n*symx + mx**2*my*myy*n*symx + mx**2*mxy*mz*n*symz - mx**2*myy*mz*n*sxmz - mx*mxz*my**2*n*szmx + mx**2*mxz*my*n*szmy - mx**2*my*mzz*n*sxmy - mx*my**2*myz*n*symz + mxx*mxy*mz**2*n*sy + mxx*myy*mz**2*n*sx + mxx*mxz*my**2*n*sz + mxx*my**2*mzz*n*sx + 2*mx**2*myy*mzz*n*sx - mxx*my*myy*n**2*symx - mxx*mxy*mz*n**2*symz + mxx*myy*mz*n**2*sxmz - mxx*mxz*my*n**2*szmy + mxx*my*mzz*n**2*sxmy + mxy*mxz*my*n**2*szmx + mxy*mxz*mz*n**2*symx + mxy*my*myz*n**2*symz - my*myy*myz*n**2*sxmz - 2*mxx*myy*mzz*n**2*sx + mx*my*mzz**2*n*sy - mx*mxz**2*mz*n*sz + mxx*my*mz**2*n*symx - mx**2*mxy*mz*n*szmy - my**2*myy*mz*n*sxmz - 2*mx*mxz*mz**2*n*szmx + mx**2*my*mzz*n*symx + mx*my**2*myz*n*szmy + my**2*myz*mz*n*sxmy + mx*myz*mz**2*n*symz + my*myz*mz**2*n*sxmz - mx**2*mz*mzz*n*sxmz + mxx*mz**2*mzz*n*sx + mxy*myy*mz**2*n*sy + mxy*my**2*myz*n*sz + my**2*myy*mzz*n*sx + mxz*myz*mz**2*n*sy + mxx*mxy*mz*n**2*szmy - mxx*my*mzz*n**2*symx + mxx*mz*mzz*n**2*sxmz - mxy*myy*mz*n**2*symz - mxy*my*myz*n**2*szmy + my*myy*mzz*n**2*sxmy - myy*myz*mz*n**2*sxmy + mxz*my*mzz*n**2*symz - mxz*myz*mz*n**2*symz - my*myz*mzz*n**2*sxmz + mx*myy**2*mz*n*sz + mxx*my**2*mz*n*szmx + mx**2*myy*mz*n*szmx - my**2*myz*mz*n*symx - mx*myz*mz**2*n*szmy - my*mz**2*mzz*n*sxmy + myy*mz**2*mzz*n*sx + mxz*my**2*mzz*n*sz - mxx*myy*mz*n**2*szmx + mxy*myy*mz*n**2*szmy + my*myy*myz*n**2*szmx - my*myy*mzz*n**2*symx + myy*myz*mz*n**2*symx + myy*mz*mzz*n**2*sxmz - mxz*my*mzz*n**2*szmy + mxz*myz*mz*n**2*szmy - myz*mz*mzz*n**2*sxmy + my**2*myy*mz*n*szmx - my*myz*mz**2*n*szmx + my*mz**2*mzz*n*symx + mx**2*mz*mzz*n*szmx - mxx*mz*mzz*n**2*szmx + my*myz*mzz*n**2*szmx + myz*mz*mzz*n**2*symx - myy*mz*mzz*n**2*szmx + 2*mx*mxy*mxz*my*mz*n + 2*mx*my*myy*myz*mz*n + 2*mx*my*myz*mz*mzz*n - 2*mx*mxx*mxy*my*n*sx - 2*mx*mxx*mxz*mz*n*sx - 2*mx*mxy*my*myy*n*sx - 2*mx*mxz*my*myz*n*sx + mx*mxy*my*mz*n*sxmz + mx*mxz*my*mz*n*sxmy + mx*mxx*my*myy*n*sy - mx*mxy*mxz*my*n*sz - mx*mxy*mxz*mz*n*sy - 2*mx*mxy*myz*mz*n*sx - mx*mxz*my*mz*n*symx + mx*mxx*my*mzz*n*sy - mxx*mxz*my*mz*n*sy - 2*mx*mxz*mz*mzz*n*sx - mx*mxy*my*mz*n*szmx + mx*my*myy*mz*n*symz + mx*mxx*myy*mz*n*sz - mxx*mxy*my*mz*n*sz - mx*my*myy*myz*n*sz + mx*my*myy*mzz*n*sy - mx*myy*myz*mz*n*sy - mxy*my*myz*mz*n*sy - mx*my*myy*mz*n*szmy - mx*my*mz*mzz*n*symz + mx*mxx*mz*mzz*n*sz - mxy*my*myy*mz*n*sz - mx*my*myz*mzz*n*sz - mx*myz*mz*mzz*n*sy - mxz*my*myz*mz*n*sz - mxz*my*mz*mzz*n*sy + mx*my*mz*mzz*n*szmy + mx*myy*mz*mzz*n*sz)/(mx**4*myy*n + mx**4*mzz*n - 2*mx**3*mxy*my*n - 2*mx**3*mxz*mz*n + mx**2*mxx*my**2*n - 2*mx**2*mxx*myy*n**2 + mx**2*mxx*mz**2*n - 2*mx**2*mxx*mzz*n**2 + mx**2*mxy**2*n**2 + mx**2*mxz**2*n**2 + mx**2*my**2*myy*n + 2*mx**2*my**2*mzz*n - 2*mx**2*my*myz*mz*n - mx**2*myy**2*n**2 + 2*mx**2*myy*mz**2*n - 2*mx**2*myy*mzz*n**2 + mx**2*mz**2*mzz*n - mx**2*mzz**2*n**2 + 2*mx*mxx*mxy*my*n**2 + 2*mx*mxx*mxz*mz*n**2 - 2*mx*mxy*my**3*n + 2*mx*mxy*my*myy*n**2 - 2*mx*mxy*my*mz**2*n + 2*mx*mxy*myz*mz*n**2 - 2*mx*mxz*my**2*mz*n + 2*mx*mxz*my*myz*n**2 - 2*mx*mxz*mz**3*n + 2*mx*mxz*mz*mzz*n**2 - mxx**2*my**2*n**2 + mxx**2*myy*n**3 - mxx**2*mz**2*n**2 + mxx**2*mzz*n**3 - mxx*mxy**2*n**3 - mxx*mxz**2*n**3 + mxx*my**4*n - 2*mxx*my**2*myy*n**2 + 2*mxx*my**2*mz**2*n - 2*mxx*my**2*mzz*n**2 + mxx*myy**2*n**3 - 2*mxx*myy*mz**2*n**2 + 2*mxx*myy*mzz*n**3 + mxx*mz**4*n - 2*mxx*mz**2*mzz*n**2 + mxx*mzz**2*n**3 + mxy**2*my**2*n**2 - mxy**2*myy*n**3 + 2*mxy*mxz*my*mz*n**2 - 2*mxy*mxz*myz*n**3 + mxz**2*mz**2*n**2 - mxz**2*mzz*n**3 + my**4*mzz*n - 2*my**3*myz*mz*n + my**2*myy*mz**2*n - 2*my**2*myy*mzz*n**2 + my**2*myz**2*n**2 + my**2*mz**2*mzz*n - my**2*mzz**2*n**2 + 2*my*myy*myz*mz*n**2 - 2*my*myz*mz**3*n + 2*my*myz*mz*mzz*n**2 - myy**2*mz**2*n**2 + myy**2*mzz*n**3 - myy*myz**2*n**3 + myy*mz**4*n - 2*myy*mz**2*mzz*n**2 + myy*mzz**2*n**3 + myz**2*mz**2*n**2 - myz**2*mzz*n**3)
trans_y = -(mxx*my**5 + my**5*mzz - 2*mx*mxy*my**4 + mx**4*my*myy + mxx*my*mz**4 + mx**4*my*mzz + my*myy*mz**4 - 2*my**4*myz*mz - mxx*my**4*sy - my**4*mzz*sy + mx**2*mxx*my**3 - 2*mx**3*mxy*my**2 + mx**2*my**3*myy + 2*mxx*my**3*mz**2 + 2*mx**2*my**3*mzz + my**3*myy*mz**2 - 2*my**2*myz*mz**3 + my**3*mz**2*mzz - mxx**2*my**3*n + mxy**2*my**3*n + my**3*myz**2*n - my**3*mzz**2*n - 2*mx*mxz*my*mz**3 - 2*mx*mxz*my**3*mz - 2*mx**3*mxz*my*mz - 2*mxx*my**3*myy*n - 2*mxx*my**3*mzz*n - 2*my**3*myy*mzz*n - mx*mxx*my**3*sx + 2*mx*mxy*my**3*sy - mx**3*my*myy*sx - mx*my**3*mzz*sx - mx**3*my*mzz*sx - mxx*my*mz**3*sz - mxx*my**3*mz*sz + 2*my**3*myz*mz*sy - my*myy*mz**3*sz - my**3*mz*mzz*sz + mx**3*myy*n*sxmy + mx**3*mxz*n*symz - mx**3*myy*n*symx - mxz*mz**3*n*sxmy - mx**3*mxz*n*szmy + mx**3*mzz*n*sxmy - mxx*mz**3*n*symz + mxz*mz**3*n*symx - mx**3*mzz*n*symx + mxx*mz**3*n*szmy - myy*mz**3*n*symz + myy*mz**3*n*szmy + mx**2*mxx*my*mz**2 - 2*mx*mxy*my**2*mz**2 + 2*mx**2*my*myy*mz**2 - 2*mx**2*my**2*myz*mz + mx**2*my*mz**2*mzz + mx**2*mxy**2*my*n + mx**2*mxz**2*my*n - mxx*mxy**2*my*n**2 - mxx*mxz**2*my*n**2 - mx**2*my*myy**2*n + mxx*my*myy**2*n**2 + mxx**2*my*myy*n**2 - mxy**2*my*myy*n**2 - mxx**2*my*mz**2*n - mx**2*my*mzz**2*n + mxz**2*my*mz**2*n + mxx*my*mzz**2*n**2 + mxx**2*my*mzz*n**2 - my*myy*myz**2*n**2 - mxz**2*my*mzz*n**2 - my*myy**2*mz**2*n + my*myz**2*mz**2*n + my*myy*mzz**2*n**2 + my*myy**2*mzz*n**2 - my*myz**2*mzz*n**2 + 2*mx**2*mxy*my**2*sx - mx**2*my**2*myy*sy - mxx*my**2*mz**2*sy - mx**2*my**2*mzz*sy - my**2*myy*mz**2*sy + 2*my**2*myz*mz**2*sz + mx*mxy**2*n**2*sxmy - mx**2*mxz**2*n*sy - mx*mxy**2*n**2*symx + mxx*mxy**2*n**2*sy + mxx*mxz**2*n**2*sy + mxx**2*my**2*n*sy + mx**2*myy**2*n*sy - mxy**2*my**2*n*sy - mx*mzz**2*n**2*sxmy - mxx*myy**2*n**2*sy - mxx**2*myy*n**2*sy + mxy**2*myy*n**2*sy - mxz**2*mz**2*n*sy - my**2*myz**2*n*sy + mxx**2*mz*n**2*symz + mx*mzz**2*n**2*symx - mxx*mzz**2*n**2*sy - mxx**2*mzz*n**2*sy + myy*myz**2*n**2*sy + mxz**2*mzz*n**2*sy + myy**2*mz**2*n*sy + my**2*mzz**2*n*sy - mxx**2*mz*n**2*szmy - myz**2*mz*n**2*symz - myy*mzz**2*n**2*sy - myy**2*mzz*n**2*sy + myz**2*mzz*n**2*sy + myz**2*mz*n**2*szmy + 2*mx*mxx*mxy*my**2*n - 2*mx**2*mxx*my*myy*n + 2*mx*mxy*my**2*myy*n + 2*mx*mxz*my**2*myz*n - 2*mxy*mxz*my*myz*n**2 - 2*mx**2*mxx*my*mzz*n + 2*mxy*mxz*my**2*mz*n - 2*mxx*my*myy*mz**2*n - 2*mx**2*my*myy*mzz*n + 2*mxx*my*myy*mzz*n**2 - 2*mxx*my*mz**2*mzz*n + 2*my**2*myy*myz*mz*n - 2*my*myy*mz**2*mzz*n + 2*my**2*myz*mz*mzz*n - mx*mxx*my*mz**2*sx + 2*mx**2*mxz*my*mz*sx - mx*my*myy*mz**2*sx + 2*mx*mxz*my**2*mz*sy + 2*mx*my**2*myz*mz*sx + 2*mx*mxy*my**2*mz*sz + 2*mx*mxz*my*mz**2*sz - mx**2*my*myy*mz*sz - mx**2*my*mz*mzz*sz + mx*mxy*mxz*n**2*sxmz - mx*mxy**2*my*n*sx + mx*mxx*my**2*n*sxmy - 2*mx**2*mxy*my*n*sxmy - mx**2*mxz*my*n*sxmz - mx*mxx*myy*n**2*sxmy - mx*mxx*mxz*n**2*symz - mx*mxx*my**2*n*symx + 2*mx**2*mxy*my*n*symx - mx**2*mxz*mz*n*sxmy - mx*my**2*myz*n*sxmz + mxx*mxy*mz**2*n*sx + mx**2*mxx*myy*n*sy + mx**2*mxy*mxz*n*sz + mx*mxx*myy*n**2*symx - mxx*mxy*mz*n**2*sxmz + mx*mxx*mxz*n**2*szmy - mx*mxx*mzz*n**2*sxmy + mxx*mxz*mz*n**2*sxmy - mx*mxy*mxz*n**2*szmx - mx*mxy*myz*n**2*symz + mx*myy*myz*n**2*sxmz + 2*mxy*mxz*myz*n**2*sy + mx*my*mzz**2*n*sx - mx**2*mxx*mz*n*symz + mx*myy*mz**2*n*sxmy - mxy*my*mz**2*n*sxmy + mxy*my**2*mz*n*sxmz + mx**2*mxz*my*n*szmx + mx**2*mxz*mz*n*symx + mx*my**2*mzz*n*sxmy + mx*mxz*mz**2*n*symz + mxz*my*mz**2*n*sxmz + mx**2*my*myz*n*symz + 2*mxx*my**2*myy*n*sy + mxy*myy*mz**2*n*sx + mx**2*mxx*mzz*n*sy + mxz*myz*mz**2*n*sx + mx*mxx*mzz*n**2*symx - mxx*mxz*mz*n**2*symx - mxy*myy*mz*n**2*sxmz + mx*mxy*myz*n**2*szmy - mx*myy*mzz*n**2*sxmy + mxy*myz*mz*n**2*sxmy - mx*mxz*mzz*n**2*symz + mx*myz*mzz*n**2*sxmz - mxz*myz*mz*n**2*sxmz + mx**2*mxx*mz*n*szmy - mxx*my**2*mz*n*symz - mx*myy*mz**2*n*symx + mxy*my*mz**2*n*symx - mx**2*myy*mz*n*symz + mx*my**2*myz*n*szmx - mx*my**2*mzz*n*symx - mx*mxz*mz**2*n*szmy + mx*mz**2*mzz*n*sxmy - mx**2*my*myz*n*szmy + mxx*myy*mz**2*n*sy + 2*mxx*my**2*mzz*n*sy + mx**2*myy*myz*n*sz + mx**2*myy*mzz*n*sy + mxx*mxy*mz*n**2*szmx + mxx*myy*mz*n**2*symz - mx*myy*myz*n**2*szmx + mx*myy*mzz*n**2*symx - mxy*myz*mz*n**2*symx + mx*mxz*mzz*n**2*szmy + mxz*mz*mzz*n**2*sxmy - 2*mxx*myy*mzz*n**2*sy + mxx**2*my*mz*n*sz + mxx*my**2*mz*n*szmy - mxy*my**2*mz*n*szmx + mx**2*myy*mz*n*szmy - mx*mz**2*mzz*n*symx - mxz*my*mz**2*n*szmx + 2*my*myz*mz**2*n*symz + mxx*mz**2*mzz*n*sy + 2*my**2*myy*mzz*n*sy + mx**2*myz*mzz*n*sz - mxx*myy*mz*n**2*szmy + mxy*myy*mz*n**2*szmx + mxx*mz*mzz*n**2*symz - mx*myz*mzz*n**2*szmx + mxz*myz*mz*n**2*szmx - mxz*mz*mzz*n**2*symx - my*myz**2*mz*n*sz - 2*my*myz*mz**2*n*szmy - my**2*mz*mzz*n*symz + myy*mz**2*mzz*n*sy - mxx*mz*mzz*n**2*szmy + myy*mz*mzz*n**2*symz + my**2*mz*mzz*n*szmy - myy*mz*mzz*n**2*szmy + 2*mx*mxx*mxz*my*mz*n + 2*mx*mxy*my*myz*mz*n + 2*mx*mxz*my*mz*mzz*n - 2*mx*mxx*mxy*my*n*sy + mx*mxx*my*myy*n*sx - mx*mxy*mxz*mz*n*sx + mx*mxx*my*mz*n*sxmz - mx*mxx*mxz*my*n*sz + mx*mxx*my*mzz*n*sx - 2*mx*mxy*my*myy*n*sy - mxx*mxz*my*mz*n*sx - 2*mx*mxz*my*myz*n*sy + mx*mxy*my*mz*n*symz - mx*my*myz*mz*n*sxmy - mx*mxx*mxy*mz*n*sz - mx*mxy*my*myz*n*sz + mx*my*myy*mzz*n*sx - mx*myy*myz*mz*n*sx - 2*mxy*mxz*my*mz*n*sy - mxy*my*myz*mz*n*sx - mx*mxx*my*mz*n*szmx - mx*mxy*my*mz*n*szmy + mx*my*myz*mz*n*symx - mx*my*mz*mzz*n*sxmz - mx*mxy*myy*mz*n*sz - mx*mxz*my*mzz*n*sz - mx*mxz*myz*mz*n*sz - mx*myz*mz*mzz*n*sx - mxz*my*mz*mzz*n*sx + mxx*my*myy*mz*n*sz - 2*my*myy*myz*mz*n*sy + mx*my*mz*mzz*n*szmx + mxx*my*mz*mzz*n*sz - 2*my*myz*mz*mzz*n*sy + my*myy*mz*mzz*n*sz)/(mx**4*myy*n + mx**4*mzz*n - 2*mx**3*mxy*my*n - 2*mx**3*mxz*mz*n + mx**2*mxx*my**2*n - 2*mx**2*mxx*myy*n**2 + mx**2*mxx*mz**2*n - 2*mx**2*mxx*mzz*n**2 + mx**2*mxy**2*n**2 + mx**2*mxz**2*n**2 + mx**2*my**2*myy*n + 2*mx**2*my**2*mzz*n - 2*mx**2*my*myz*mz*n - mx**2*myy**2*n**2 + 2*mx**2*myy*mz**2*n - 2*mx**2*myy*mzz*n**2 + mx**2*mz**2*mzz*n - mx**2*mzz**2*n**2 + 2*mx*mxx*mxy*my*n**2 + 2*mx*mxx*mxz*mz*n**2 - 2*mx*mxy*my**3*n + 2*mx*mxy*my*myy*n**2 - 2*mx*mxy*my*mz**2*n + 2*mx*mxy*myz*mz*n**2 - 2*mx*mxz*my**2*mz*n + 2*mx*mxz*my*myz*n**2 - 2*mx*mxz*mz**3*n + 2*mx*mxz*mz*mzz*n**2 - mxx**2*my**2*n**2 + mxx**2*myy*n**3 - mxx**2*mz**2*n**2 + mxx**2*mzz*n**3 - mxx*mxy**2*n**3 - mxx*mxz**2*n**3 + mxx*my**4*n - 2*mxx*my**2*myy*n**2 + 2*mxx*my**2*mz**2*n - 2*mxx*my**2*mzz*n**2 + mxx*myy**2*n**3 - 2*mxx*myy*mz**2*n**2 + 2*mxx*myy*mzz*n**3 + mxx*mz**4*n - 2*mxx*mz**2*mzz*n**2 + mxx*mzz**2*n**3 + mxy**2*my**2*n**2 - mxy**2*myy*n**3 + 2*mxy*mxz*my*mz*n**2 - 2*mxy*mxz*myz*n**3 + mxz**2*mz**2*n**2 - mxz**2*mzz*n**3 + my**4*mzz*n - 2*my**3*myz*mz*n + my**2*myy*mz**2*n - 2*my**2*myy*mzz*n**2 + my**2*myz**2*n**2 + my**2*mz**2*mzz*n - my**2*mzz**2*n**2 + 2*my*myy*myz*mz*n**2 - 2*my*myz*mz**3*n + 2*my*myz*mz*mzz*n**2 - myy**2*mz**2*n**2 + myy**2*mzz*n**3 - myy*myz**2*n**3 + myy*mz**4*n - 2*myy*mz**2*mzz*n**2 + myy*mzz**2*n**3 + myz**2*mz**2*n**2 - myz**2*mzz*n**3)
trans_z = -(mxx*mz**5 + myy*mz**5 - 2*mx*mxz*mz**4 + mxx*my**4*mz + mx**4*myy*mz - 2*my*myz*mz**4 + mx**4*mz*mzz + my**4*mz*mzz - mxx*mz**4*sz - myy*mz**4*sz + mx**2*mxx*mz**3 - 2*mx**3*mxz*mz**2 + 2*mxx*my**2*mz**3 + 2*mx**2*myy*mz**3 + my**2*myy*mz**3 + mx**2*mz**3*mzz - 2*my**3*myz*mz**2 + my**2*mz**3*mzz - mxx**2*mz**3*n + mxz**2*mz**3*n - myy**2*mz**3*n + myz**2*mz**3*n - 2*mx*mxy*my*mz**3 - 2*mx*mxy*my**3*mz - 2*mx**3*mxy*my*mz - 2*mxx*myy*mz**3*n - 2*mxx*mz**3*mzz*n - 2*myy*mz**3*mzz*n - mx*mxx*mz**3*sx - mx*myy*mz**3*sx - mx**3*myy*mz*sx - mxx*my*mz**3*sy - mxx*my**3*mz*sy + 2*mx*mxz*mz**3*sz - mx**3*mz*mzz*sx - my*myy*mz**3*sy + 2*my*myz*mz**3*sz - my**3*mz*mzz*sy - mxy*my**3*n*sxmz - mx**3*mxy*n*symz + mx**3*myy*n*sxmz + mxx*my**3*n*symz + mx**3*mxy*n*szmy + mx**3*mzz*n*sxmz - mxx*my**3*n*szmy + mxy*my**3*n*szmx - mx**3*myy*n*szmx - mx**3*mzz*n*szmx + my**3*mzz*n*symz - my**3*mzz*n*szmy + mx**2*mxx*my**2*mz - 2*mx*mxz*my**2*mz**2 + mx**2*my**2*myy*mz - 2*mx**2*my*myz*mz**2 + 2*mx**2*my**2*mz*mzz + mx**2*mxy**2*mz*n + mx**2*mxz**2*mz*n - mxx*mxy**2*mz*n**2 - mxx*mxz**2*mz*n**2 - mxx**2*my**2*mz*n - mx**2*myy**2*mz*n + mxy**2*my**2*mz*n + mxx*myy**2*mz*n**2 + mxx**2*myy*mz*n**2 - mxy**2*myy*mz*n**2 - mx**2*mz*mzz**2*n + my**2*myz**2*mz*n + mxx*mz*mzz**2*n**2 + mxx**2*mz*mzz*n**2 - myy*myz**2*mz*n**2 - mxz**2*mz*mzz*n**2 - my**2*mz*mzz**2*n + myy*mz*mzz**2*n**2 + myy**2*mz*mzz*n**2 - myz**2*mz*mzz*n**2 + 2*mx**2*mxz*mz**2*sx - mxx*my**2*mz**2*sz - mx**2*myy*mz**2*sz + 2*my**2*myz*mz**2*sy - mx**2*mz**2*mzz*sz - my**2*mz**2*mzz*sz + mx*mxz**2*n**2*sxmz - mx*myy**2*n**2*sxmz - mx**2*mxy**2*n*sz - mxx**2*my*n**2*symz - mx*mxz**2*n**2*szmx + mxx*mxy**2*n**2*sz + mxx*mxz**2*n**2*sz - mxy**2*my**2*n*sz + mxx**2*my*n**2*szmy + mx*myy**2*n**2*szmx + my*myz**2*n**2*symz - mxx*myy**2*n**2*sz - mxx**2*myy*n**2*sz + mxy**2*myy*n**2*sz + mxx**2*mz**2*n*sz + mx**2*mzz**2*n*sz - mxz**2*mz**2*n*sz - my*myz**2*n**2*szmy - mxx*mzz**2*n**2*sz - mxx**2*mzz*n**2*sz + myy*myz**2*n**2*sz + mxz**2*mzz*n**2*sz + myy**2*mz**2*n*sz + my**2*mzz**2*n*sz - myz**2*mz**2*n*sz - myy*mzz**2*n**2*sz - myy**2*mzz*n**2*sz + myz**2*mzz*n**2*sz + 2*mx*mxx*mxz*mz**2*n - 2*mx**2*mxx*myy*mz*n + 2*mx*mxy*myz*mz**2*n + 2*mxy*mxz*my*mz**2*n - 2*mxy*mxz*myz*mz*n**2 - 2*mxx*my**2*myy*mz*n - 2*mx**2*mxx*mz*mzz*n + 2*mx*mxz*mz**2*mzz*n - 2*mxx*my**2*mz*mzz*n + 2*my*myy*myz*mz**2*n - 2*mx**2*myy*mz*mzz*n + 2*mxx*myy*mz*mzz*n**2 - 2*my**2*myy*mz*mzz*n + 2*my*myz*mz**2*mzz*n - mx*mxx*my**2*mz*sx + 2*mx**2*mxy*my*mz*sx + 2*mx*mxy*my**2*mz*sy + 2*mx*mxz*my*mz**2*sy + 2*mx*my*myz*mz**2*sx + 2*mx*mxy*my*mz**2*sz - mx**2*my*myy*mz*sy - mx*my**2*mz*mzz*sx - mx**2*my*mz*mzz*sy + mx*mxy*mxz*n**2*sxmy - mx**2*mxy*my*n*sxmz + mxx*mxz*my**2*n*sx + mx**2*mxy*mxz*n*sy + mx*mxx*mxy*n**2*symz - mx*mxx*myy*n**2*sxmz + mxx*mxy*my*n**2*sxmz - mxx*mxz*my*n**2*sxmy - mx*mxy*mxz*n**2*symx - mx*mxz**2*mz*n*sx + mx*mxx*mz**2*n*sxmz + mx**2*mxx*my*n*symz - mx**2*mxy*mz*n*sxmy - mx*mxy*my**2*n*symz + mx*my**2*myy*n*sxmz - 2*mx**2*mxz*mz*n*sxmz + mxy*my**2*myz*n*sx - mx*mxx*mxy*n**2*szmy + mxx*mxz*my*n**2*symx - mx*mxx*mzz*n**2*sxmz + mx*mxy*myy*n**2*symz + mxy*my*myy*n**2*sxmz + mx*myy*myz*n**2*sxmy - mxy*my*myz*n**2*sxmy + mx*mxz*myz*n**2*symz + mxz*my*myz*n**2*sxmz + mx*myy**2*mz*n*sx - mx**2*mxx*my*n*szmy + mx**2*mxy*my*n*szmx + mx**2*mxy*mz*n*symx + mx*mxy*my**2*n*szmy + mxy*my**2*mz*n*sxmy + mx*myy*mz**2*n*sxmz - mx*myz*mz**2*n*sxmy + mxz*my*mz**2*n*sxmy + mx*my**2*mzz*n*sxmz - mxz*my**2*mz*n*sxmz + mx**2*mxx*myy*n*sz + mx**2*myy*myz*n*sy + mxz*my**2*mzz*n*sx + mx*mxx*myy*n**2*szmx - mxx*mxy*my*n**2*szmx - mxx*my*myy*n**2*symz - mx*mxy*myy*n**2*szmy - mx*myy*myz*n**2*symx + mxy*my*myz*n**2*symx - mx*myy*mzz*n**2*sxmz - mx*mxz*myz*n**2*szmy + mx*myz*mzz*n**2*sxmy - mxz*my*mzz*n**2*sxmy + 2*mxy*mxz*myz*n**2*sz + mxx**2*my*mz*n*sy - mx*mxx*mz**2*n*szmx + mxx*my*mz**2*n*symz - mx*my**2*myy*n*szmx - mxy*my**2*mz*n*symx + mx*myz*mz**2*n*symx - mxz*my*mz**2*n*symx + 2*mx**2*mxz*mz*n*szmx + mx**2*my*mzz*n*symz - mx**2*myz*mz*n*symz + mxx*my**2*myy*n*sz + mx**2*mxx*mzz*n*sz + mx**2*myz*mzz*n*sy + mxx*my*myy*n**2*szmy + mx*mxx*mzz*n**2*szmx - mxy*my*myy*n**2*szmx - mxx*my*mzz*n**2*symz - mx*myz*mzz*n**2*symx - mxz*my*myz*n**2*szmx + mxz*my*mzz*n**2*symx - my*myz**2*mz*n*sy - mxx*my*mz**2*n*szmy - mx*myy*mz**2*n*szmx + my*myy*mz**2*n*symz - mx*my**2*mzz*n*szmx + mxz*my**2*mz*n*szmx - mx**2*my*mzz*n*szmy + mx**2*myz*mz*n*szmy - 2*my**2*myz*mz*n*symz + 2*mxx*myy*mz**2*n*sz + mxx*my**2*mzz*n*sz + mx**2*myy*mzz*n*sz + mxx*my*mzz*n**2*szmy + mx*myy*mzz*n**2*szmx - my*myy*mzz*n**2*symz - 2*mxx*myy*mzz*n**2*sz - my*myy*mz**2*n*szmy + 2*my**2*myz*mz*n*szmy + 2*mxx*mz**2*mzz*n*sz + my**2*myy*mzz*n*sz + my*myy*mzz*n**2*szmy + 2*myy*mz**2*mzz*n*sz + 2*mx*mxx*mxy*my*mz*n + 2*mx*mxy*my*myy*mz*n + 2*mx*mxz*my*myz*mz*n - mx*mxy*mxz*my*n*sx - mx*mxx*mxz*my*n*sy + mx*mxx*my*mz*n*sxmy - mx*mxx*mxy*mz*n*sy + mx*mxx*myy*mz*n*sx - mxx*mxy*my*mz*n*sx - mx*mxy*my*myz*n*sy - mx*my*myy*myz*n*sx - mx*mxx*my*mz*n*symx - mx*my*myy*mz*n*sxmy - mx*mxz*my*mz*n*symz - mx*my*myz*mz*n*sxmz - 2*mx*mxx*mxz*mz*n*sz + mx*mxx*mz*mzz*n*sx - mx*mxy*myy*mz*n*sy - mxy*my*myy*mz*n*sx - mx*mxz*my*mzz*n*sy - mx*mxz*myz*mz*n*sy - mx*my*myz*mzz*n*sx - mxz*my*myz*mz*n*sx + mx*my*myy*mz*n*symx + mx*mxz*my*mz*n*szmy + mxx*my*myy*mz*n*sy - 2*mx*mxy*myz*mz*n*sz + mx*myy*mz*mzz*n*sx - 2*mxy*mxz*my*mz*n*sz + mx*my*myz*mz*n*szmx + mxx*my*mz*mzz*n*sy - 2*mx*mxz*mz*mzz*n*sz - 2*my*myy*myz*mz*n*sz + my*myy*mz*mzz*n*sy - 2*my*myz*mz*mzz*n*sz)/(mx**4*myy*n + mx**4*mzz*n - 2*mx**3*mxy*my*n - 2*mx**3*mxz*mz*n + mx**2*mxx*my**2*n - 2*mx**2*mxx*myy*n**2 + mx**2*mxx*mz**2*n - 2*mx**2*mxx*mzz*n**2 + mx**2*mxy**2*n**2 + mx**2*mxz**2*n**2 + mx**2*my**2*myy*n + 2*mx**2*my**2*mzz*n - 2*mx**2*my*myz*mz*n - mx**2*myy**2*n**2 + 2*mx**2*myy*mz**2*n - 2*mx**2*myy*mzz*n**2 + mx**2*mz**2*mzz*n - mx**2*mzz**2*n**2 + 2*mx*mxx*mxy*my*n**2 + 2*mx*mxx*mxz*mz*n**2 - 2*mx*mxy*my**3*n + 2*mx*mxy*my*myy*n**2 - 2*mx*mxy*my*mz**2*n + 2*mx*mxy*myz*mz*n**2 - 2*mx*mxz*my**2*mz*n + 2*mx*mxz*my*myz*n**2 - 2*mx*mxz*mz**3*n + 2*mx*mxz*mz*mzz*n**2 - mxx**2*my**2*n**2 + mxx**2*myy*n**3 - mxx**2*mz**2*n**2 + mxx**2*mzz*n**3 - mxx*mxy**2*n**3 - mxx*mxz**2*n**3 + mxx*my**4*n - 2*mxx*my**2*myy*n**2 + 2*mxx*my**2*mz**2*n - 2*mxx*my**2*mzz*n**2 + mxx*myy**2*n**3 - 2*mxx*myy*mz**2*n**2 + 2*mxx*myy*mzz*n**3 + mxx*mz**4*n - 2*mxx*mz**2*mzz*n**2 + mxx*mzz**2*n**3 + mxy**2*my**2*n**2 - mxy**2*myy*n**3 + 2*mxy*mxz*my*mz*n**2 - 2*mxy*mxz*myz*n**3 + mxz**2*mz**2*n**2 - mxz**2*mzz*n**3 + my**4*mzz*n - 2*my**3*myz*mz*n + my**2*myy*mz**2*n - 2*my**2*myy*mzz*n**2 + my**2*myz**2*n**2 + my**2*mz**2*mzz*n - my**2*mzz**2*n**2 + 2*my*myy*myz*mz*n**2 - 2*my*myz*mz**3*n + 2*my*myz*mz*mzz*n**2 - myy**2*mz**2*n**2 + myy**2*mzz*n**3 - myy*myz**2*n**3 + myy*mz**4*n - 2*myy*mz**2*mzz*n**2 + myy*mzz**2*n**3 + myz**2*mz**2*n**2 - myz**2*mzz*n**3)

rot = np.array([[1, -gamma, -betha],
                [gamma, 1, -alpha],
                [betha, alpha, 1]])
trans = np.array([trans_x, trans_y, trans_z])
print(np.identity(3) - np.dot(rot_1, rot), end='\n\n')
print(trans_1+trans, end='\n\n')

c = np.zeros((n,3))
for i, point in enumerate(b):
    c[i] = np.dot(rot, point) + trans
print(c, end='\n\n')

print(count_eps(a, c), end='\n\n')
print(count_eps(a, b), end='\n\n')

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.scatter(a[:,0], a[:,1], a[:,2], s=30, c='#0000ff', marker='o')
ax.scatter(b[:,0], b[:,1], b[:,2], s=30, c='#828200', marker='<')
ax.scatter(d[:,0], d[:,1], d[:,2], s=30, c='#008282', marker='>')
ax.scatter(c[:,0], c[:,1], c[:,2], s=30, c='#ff0000', marker='*')
ax.legend(['Initial A', 'Trans B', 'B no trans', 'Final'])
plt.show()
